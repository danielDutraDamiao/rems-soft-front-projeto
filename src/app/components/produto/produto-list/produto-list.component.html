<div class="card">
    <p-table [value]="produtos" dataKey="id" [tableStyle]="{ 'min-width': '60rem' }">
        <ng-template pTemplate="header">
            <tr>
                <th style="width: 5rem"></th>
                <th pSortableColumn="id">NÃºmero do Produto <p-sortIcon field="id"></p-sortIcon></th>
                <th pSortableColumn="valorProduto">Valor Total <p-sortIcon field="valorProduto"></p-sortIcon></th>
                <th>Nome do Fornecedor</th>
                <th pSortableColumn="quantidade">Total Produtos <p-sortIcon field="quantidade"></p-sortIcon></th>
            </tr>
        </ng-template>
        <ng-template pTemplate="body" let-produto let-expanded="expanded">
            <tr>
                <td>
                    <button type="button" pButton pRipple [pRowToggler]="produto" class="p-button-text p-button-rounded p-button-plain" [icon]="expanded ? 'pi pi-chevron-down' : 'pi pi-chevron-right'"></button>
                </td>
                <td>{{ produto.id }}</td>
                <td>{{ produto.valorProduto | currency: 'BRL' }}</td>
                <td>{{ produto.nomeFornecedor}}</td>
                <td>{{ produto.quantidade }}</td>
            </tr>
        </ng-template>
        <ng-template pTemplate="rowexpansion" let-produto>
            <tr>
                <td colspan="5">
                    <div class="p-3">
                        <p-table [value]="produto.produtos" dataKey="id">
                            <ng-template pTemplate="header">
                                <tr>
                                    <th pSortableColumn="id">Id <p-sortIcon field="id"></p-sortIcon></th>
                                    <th pSortableColumn="nomeProduto">Nome do Produto <p-sortIcon field="nomeProduto"></p-sortIcon></th>
                                    <th pSortableColumn="valorProduto">Valor <p-sortIcon field="valorProduto"></p-sortIcon></th>
                                    <th>Fornecedor</th>
                                </tr>
                            </ng-template>
                            <ng-template pTemplate="body" let-produto>
                                <tr>
                                    <td>{{ produto.id }}</td>
                                    <td>{{ produto.nomeProduto }}</td>
                                    <td>{{ produto.valorProduto | currency: 'BRL' }}</td>
                                    <td>{{ produto.fornecedor.nome }}</td>
                                </tr>
                            </ng-template>
                            <ng-template pTemplate="emptymessage">
                                <tr>
                                    <td colspan="5">Nenhum fornecedor encontrado para este produto.</td>
                                </tr>
                            </ng-template>
                        </p-table>
                    </div>
                </td>
            </tr>
        </ng-template>
    </p-table>
</div>
